SubObjectMapping=new Class({mapToSubObject:function(){Object.each(this.subObjectMapping,function(subObjectOptions,subObject){if(subObject=eval(subObject),void 0!==subObjectOptions.properties&&subObjectOptions.properties.length>0&&this.mapProperties(subObjectOptions.properties,subObject),void 0!==subObjectOptions.functions&&subObjectOptions.functions.length>0&&this.mapFunctions(subObjectOptions.functions,subObject),void 0!==subObjectOptions.events&&subObjectOptions.events.length>0){var options=subObjectOptions.eventOptions||{};options.instance=options.instance&&""!==options.instance?eval(options.instance):subObject,options.addFunction=options.addFunction&&""!==options.addFunction?options.addFunction:"addEvent",options.addObjectAsParam="boolean"===typeOf(options.addObjectAsParam)?options.addObjectAsParam:!1,this.mapEvents(subObjectOptions.events,subObject,options)}},this)},mapProperties:function(t,e){t.each(function(t){var n="get"+t.capitalize();this[n]=function(){return e[n]()};var o="set"+t.capitalize();this[o]=function(){e[o].apply(e,Array.from(arguments))}},this)},mapFunctions:function(t,e){t.each(function(t){this[t]=function(){return e[t].apply(e,Array.from(arguments))}},this)},mapEvents:function(t,e,n){t.each(function(t){n.addObjectAsParam===!0?n.instance[n.addFunction](e,t,function(){this.fireEvent.apply(this,[t,Array.from(arguments)])}.bind(this)):n.instance[n.addFunction](t,function(){this.fireEvent.apply(this,[t,Array.from(arguments)])}.bind(this))},this)}}),Pano.Hotspot=new Class({Implements:[Options,Events,Pano.PluginHotspotCommons],options:{},$pano:null,$type:"hotspot",initialize:function(t,e,n,o){this.setOptions(o),Object.merge(this.options,{name:t,url:e}),this.$pano=n,this.$pano.addhotspot(t),this.$pano.hotspots[this.options.name]=this,this.setKrpanoOptions(),this.setEvents()},remove:function(){this.$pano.removehotspot(this.options.name),delete this.$pano.hotspots[this.options.name],delete this}}),Pano.implement({hotspots:{},createhotspot:function(t,e,n){var o=new Pano.Hotspot(t,e,this,n);return o}}),Pano.Plugin=new Class({Implements:[Options,Events,Pano.PluginHotspotCommons],options:{},$pano:null,$type:"plugin",initialize:function(t,e,n,o){this.setOptions(o),Object.merge(this.options,{name:t,url:e}),this.$pano=n,this.$pano.addplugin(t),this.$pano.plugins[this.options.name]=this,this.setKrpanoOptions(),this.setEvents()},changeorigin:function(t,e){this.call("changeorigin",t,e)},remove:function(){this.$pano.removeplugin(this.options.name),delete this.$pano.plugins[this.options.name],delete this}}),Pano.implement({plugins:{},createplugin:function(t,e,n){var o=new Pano.Plugin(t,e,this,n);return o}}),Pano.PluginHotspotCommons=new Class({setKrpanoOptions:function(){Object.each(this.options,function(t,e){"name"!==e&&this.set(e,t)},this)}.protect(),set:function(t,e){var n=this.$type,o=n.concat("[",this.options.name,"].",t);this.$pano.set(o,e)},get:function(t){var e=this.$type,n=e.concat("[",this.options.name,"].",t);return this.$pano.get(n)},call:function(){var t=Array.from(arguments),e=t.shift(),n=this.$type,o=n.concat("[",this.options.name,"].",e);this.$pano.call(o.concat("(",String.from(t),");"))},getposition:function(){var t=this.$type;return"plugin"===t?{x:this.get("plugin".concat("[",this.options.name,"].x")),y:this.get("plugin".concat("[",this.options.name,"].y"))}:{ath:this.get("hotspot".concat("[",this.options.name,"].ath")),atv:this.get("hotspot".concat("[",this.options.name,"].atv"))}},loadstyle:function(t){this.call("loadstyle",t)},resetsize:function(){this.call("resetsize")},getloading:function(){return this.get("loading")},getloaded:function(){return this.get("loaded")},getpressed:function(){return this.get("pressed")},gethovering:function(){return this.get("hovering")},setalpha:function(t){this.set("alpha",t)},togglevisible:function(){this.get("visible")?this.set("visible",0):this.set("visible",1)},toggleenabled:function(){this.get("enabled")?this.set("enabled",0):this.set("enabled",1)},rotate:function(){var t=Array.from(arguments),e=t.shift();this.tween("rotate",e,t)},hide:function(){this.tween("alpha",0),this.set("visible",!1)},show:function(){this.set("visible",!0),this.tween("alpha",1)},tween:function(){var t=Array.from(arguments);property=t.shift();var e=this.$type;this.$pano.tween(e.concat("[",this.options.name,"].",property,",",String.from(t)))},moveTo:function(t,e){this.set("x",t),this.set("y",e)},panto:function(){var t=instanceOf(this,Pano.Plugin)?"x":"ath",e=instanceOf(this,Pano.Plugin)?"y":"atv",n=Array.from(arguments),o=n.shift(),s=n.shift();this.tween(t,o,String.from(n)),this.tween(e,s,String.from(n))},$eventsObj:["onover","onhover","onout","onclick","ondown","onup","onloaded","altonloaded"],setEvents:function(){var t=this.$type;this.$eventsObj.each(function(e){this.set(e,"js(MooKrpano_Global_SuperObject.panos.".concat(this.$pano.options.parameters.id,".",t,"s","['",this.options.name,"'].",e,"());"))},this)}.protect(),onover:function(){this.fireEvent("over")},onhover:function(){this.fireEvent("hover")},onout:function(){this.fireEvent("out")},onclick:function(){this.fireEvent("click")},ondown:function(){this.fireEvent("down")},onup:function(){this.fireEvent("up")},onloaded:function(){this.fireEvent("loaded")},altonloaded:function(){this.fireEvent("altonloaded")}}),Pano.PolygonalHotspot=new Class({Implements:[Options,Events,Pano.PluginHotspotCommons],options:{},$pano:null,$type:"hotspot",$pointsArray:[],initialize:function(t,e,n,o){this.setOptions(o),Object.merge(this.options,{name:t}),this.$pointsArray=e,this.$pano=n,this.$pano.addhotspot(t),this.$pano.hotspots[this.options.name]=this,Object.each(this.options,function(t,e){"name"!==e&&this.set(e,t)},this),this.setPoints(),this.setEvents()},setPoints:function(){"array"===typeOf(this.$pointsArray)&&this.$pointsArray.each(function(t,e){if("array"===typeOf(t)&&2===t.length){var n="number"===typeOf(t[0])?t[0]:0,o="number"===typeOf(t[1])?t[1]:0;this.set("point["+e+"].ath",n),this.set("point["+e+"].atv",o)}},this)}.protect(),addpoint:function(t,e){var n=this.$pointsArray.length;this.$pointsArray.push([t,e]),this.set("point["+n+"].ath",t),this.set("point["+n+"].atv",e)},changepoint:function(t,e,n){var o=this.$pointsArray.length;n>=0&&o>=n&&(this.$pointsArray[n]=[t,e],this.set("point["+n+"].ath",t),this.set("point["+n+"].atv",e))},getpoints:function(){return this.$pointsArray},getposition:function(){return null}}),Pano.hasOwnProperty("hotspots")||Pano.implement({hotspots:{}}),Pano.implement({createpolygonalhotspot:function(t,e,n){var o=new Pano.PolygonalHotspot(t,e,this,n);return o}}),Pano.SoundInterface=new Class({Implements:[Options,Events,SubObjectMapping],subObjectMapping:{"this.$pano":{subFunctionOptions:{subFunction:"call",enclose:!0},subFunctions:["preloadsound","playsound","playsound2D","playsound3D","playsound3Dh","playsound3DHS","pausesound","resumesound","pausesoundtoggle","stopsound","stopallsounds"]}},options:{name:"mookrpano_soundinterface",url:"%SWFPATH%/plugins/soundinterface.swf",rootpath:"%SWFPATH%/sounds/"},$eventsObj:["onloaded"],$pano:null,$type:"plugin",initialize:function(t,e){this.setOptions(e),this.$pano=t,this.$pano.addplugin(this.options.name),this.$pano.plugins[this.options.name]=this,this.setKrpanoOptions(),this.setEvents(),this.mapToSubObject()},setKrpanoOptions:function(){Object.each(this.options,function(t,e){"name"!==e&&this.set(e,t)},this)}.protect(),set:function(t,e){this.$pano.set("plugin".concat("[",this.options.name,"].",t),e)},get:function(t){return this.$pano.get("plugin".concat("[",this.options.name,"].",t))},tween:function(){var t=Array.from(arguments);property=t.shift(),this.$pano.tween("plugin".concat("[",this.options.name,"].",property,",",String.from(t)))},setEvents:function(){this.$eventsObj.each(function(t){this.set(t,"js(MooKrpano_Global_SuperObject.panos.".concat(this.$pano.options.parameters.id,".","plugins['",this.options.name,"'].",t,"());"))},this)}.protect(),onloaded:function(){this.fireEvent("loaded")},getvolume:function(){var t=this.get("volume");return t},setvolume:function(t){this.set("volume",t)},setmute:function(t){this.set("mute",t)},tweenvolume:function(){var t=Array.from(arguments),e=t.shift();this.tween("volume",e,String.from(t))}}),Pano.hasOwnProperty("plugins")||Pano.implement({plugins:{}}),Pano.implement({createsoundinterface:function(t){var e=new Pano.SoundInterface(this,t);return e}}),Pano.TextfieldHotspot=new Class({Extends:Pano.Hotspot,options:{url:"%SWFPATH%/plugins/texfield.swf",html:"loading...",css:""},gethtml:function(){return this.get("html")},getcss:function(){return this.get("css")},sethtml:function(t){this.set("css",t)},setcss:function(t){this.set("css",t)},appendhtml:function(t){t=this.gethtml().concat(t),this.sethtml(t)},appendcss:function(t){t=this.getcss().concat(t),this.setcss(t)},hidebackground:function(){this.set("background",!1)},showbackground:function(){this.set("background",!0)},togglebackground:function(){"true"==this.get("background")?this.set("background",!1):this.set("background",!0)}}),Pano.implement({createtextfieldhotspot:function(t,e,n){var o=new Pano.TextfieldHotspot(t,e,this,n);return o}}),Pano.TextfieldPlugin=new Class({Extends:Pano.Plugin,options:{url:"%SWFPATH%/plugins/texfield.swf",html:"loading...",css:""},gethtml:function(){return this.get("html")},getcss:function(){return this.get("css")},sethtml:function(t){this.set("css",t)},setcss:function(t){this.set("css",t)},appendhtml:function(t){t=this.gethtml().concat(t),this.sethtml(t)},appendcss:function(t){t=this.getcss().concat(t),this.setcss(t)},hidebackground:function(){this.set("background",!1)},showbackground:function(){this.set("background",!0)},togglebackground:function(){"true"==this.get("background")?this.set("background",!1):this.set("background",!0)}}),Pano.implement({createtextfieldplugin:function(t,e,n){var o=new Pano.TextfieldPlugin(t,e,this,n);return o}}),Pano.VideoHotspot=new Class({Extends:Pano.Hotspot,Implements:[SubObjectMapping],subObjectMapping:{"this":{subFunctionOptions:{subFunction:"call",enclose:!0},subFunctions:["playvideo","closevideo","stop","play","resume","togglepause"]}},options:{url:"%SWFPATH%/plugins/videoplayer.swf"},$eventsObj:["onvideocomplete","onover","onhover","onout","onclick","ondown","onup","onloaded","altonloaded"],initialize:function(t,e,n,o){this.setOptions(o),Object.merge(this.options,{name:t,videourl:e}),this.$pano=n,this.$pano.addhotspot(t),this.$pano.hotspots[this.options.name]=this,this.setKrpanoOptions(),this.setEvents(),this.mapToSubObject()},onvideocomplete:function(){this.fireEvent("videocomplete")},pause:function(){this.getpaused()||this.togglepause()},getpaused:function(){return this.get("ispaused")},setvolume:function(t){t=t.limit(0,1),this.set("volume",t)},setloop:function(t){t="boolean"===typeOf(t)?t:!0,this.set("loop",t)},tweenVolume:function(){var t=Array.from(arguments),e=t.shift();this.tween("volume",e,String.from(t))}}),Pano.implement({createvideohotspot:function(t,e,n){var o=new Pano.VideoHotspot(t,e,this,n);return o}}),Pano.VideoPlugin=new Class({Extends:Pano.Plugin,Implements:[SubObjectMapping],subObjectMapping:{"this":{subFunctionOptions:{subFunction:"call",enclose:!0},subFunctions:["playvideo","closevideo","stop","play","resume","togglepause"]}},options:{url:"%SWFPATH%/plugins/videoplayer.swf"},$eventsObj:["onvideocomplete","onover","onhover","onout","onclick","ondown","onup","onloaded","altonloaded"],initialize:function(t,e,n,o){this.setOptions(o),Object.merge(this.options,{name:t,videourl:e}),this.$pano=n,this.$pano.addplugin(t),this.$pano.plugins[this.options.name]=this,this.setKrpanoOptions(),this.setEvents(),this.mapToSubObject()},onvideocomplete:function(){this.fireEvent("videocomplete")},pause:function(){this.getpaused()||this.togglepause()},getpaused:function(){return this.get("ispaused")},setvolume:function(t){t=t.limit(0,1),this.set("volume",t)},setloop:function(t){t="boolean"===typeOf(t)?t:!0,this.set("loop",t)},tweenVolume:function(){var t=Array.from(arguments),e=t.shift();this.tween("volume",e,String.from(t))}}),Pano.implement({createvideoplugin:function(t,e,n){var o=new Pano.VideoPlugin(t,e,this,n);return o}}),Pano.VideoPluginHotspotCommons=new Class({}),Pano=new Class({Extends:Pano,initialize:function(t,e,n){this.parent(t,e,n),$(this.options.parameters.target).setStyles({position:"relative",overflow:"hidden"})},onviewchange:function(){this.parent(),Object.each(this.virtualhotspots,function(t){t._updatescreenposition()})}}),Pano.VirtualHotspot=new Class({Implements:[Options,Events],options:{ath:0,atv:0},$pano:null,$type:"virtualhotspot",$el:null,initialize:function(t,e,n,o){this.setOptions(o),Object.merge(this.options,{name:t}),this.$el=e,this.$pano=n,this.$pano.virtualhotspots[t]=this,this.$el.setStyle("position","absolute"),this.$el.inject($(this.$pano.options.parameters.target),"top"),this._updatescreenposition()},_updatescreenposition:function(){var t=this.$pano.spheretoscreen(this.options.ath,this.options.atv),e=Number.from(t.x),n=Number.from(t.y);e&&n&&this.$el.setStyles({left:e,top:n})},remove:function(){delete this.$pano.virtualhotspots[this.options.name],delete this}}),Pano.implement({virtualhotspots:{},createvirtualhotspot:function(t,e,n){var o=new Pano.VirtualHotspot(t,e,this,n);return o}}),SubObjectMapping=new Class({Extends:SubObjectMapping,mapToSubObject:function(){this.parent(),Object.each(this.subObjectMapping,function(subObjectOptions,subObject){if(subObject=eval(subObject),void 0!==subObjectOptions.subFunctions&&subObjectOptions.subFunctions.length>0){var options=subObjectOptions.subFunctionOptions||{};if(!options.subFunction)throw"At least subFunctionOptions.subFunction is required";options.enclose=options.enclose&&""!==options.enclose?options.enclose:!1,options.subObject=void 0!==options.subObject&&null!==options.subObject?options.subObject:subObject,this.mapSubFunctions(subObjectOptions.subFunctions,options.subFunction,options.subObject,options)}},this)},mapSubFunctions:function(t,e,n,o){t.each(function(t){this[t]=function(){var s=String.from(Array.from(arguments));return s=o.enclose?"(".concat(s,");"):s,n[e].pass(t.concat(s),this)()}},this)}}),Pano=new Class({Implements:[Options,Events,SubObjectMapping],subObjectMapping:{"this.$panoObj":{functions:["set","get","call"]},"this.$viewer":{functions:["isHTML5possible","isDevice"]},"this":{subFunctionOptions:{subFunction:"call",enclose:!0},subFunctions:["copy","action","delayedcall","switch","push","pop","stopall","breakall","add","sub","mul","div","mod","pow","inc","dec","roundval","txtadd","tween","stoptween","loadpano","loadscene","loadxml","reloadpano","openurl","lookat","lookto","looktohotspot","moveto","zoomto","adjusthlookat","wait","freezeview","oninterrupt","showtext","updateobject","updatescreen","invalidatescreen","addplugin","removeplugin","addhotspot","removehotspot","addlensflare","removelensflare","showlog","trace","error"]}},options:{parameters:{target:"pano_canvas",id:"panoObject"},viewerParams:{wmode:"opaque",allowScriptAccess:!0},krpanoVars:{},passQueryParameters:!1},$eventsObj:["onenterfullscreen","onexitfullscreen","onxmlcomplete","onpreviewcomplete","onload","onloaderror","onkeydown","onkeypup","onclick","onmousedown","onmouseup","onmousewheel","onidle","onviewchange","onresize"],$viewer:null,$panoObj:null,$percentLoaded:0,$device:null,initialize:function(t,e,n){this.setOptions(n),this.options.parameters.target=t,this.options.parameters.swf=e,this.$viewer=createPanoViewer(this.options.parameters),this.options.krpanoVars&&Object.each(this.options.krpanoVars,function(t,e){this.$viewer.addVariable(e,t)},this),Object.each(this.options.viewerParams,function(t,e){this.$viewer.addParam(e,t)},this),this.options.passQueryParameters===!0&&this.$viewer.passQueryParameters(),this.$viewer.embed(),this.onReadyListener(),this.mapToSubObject()},getObject:function(){return this.$panoObj},onReadyListener:function(){this.getObject()||(this.$panoObj=$(this.options.parameters.id)),this.isReady()?this.domReady():this.onReadyListener.delay(1e3,this)},isReady:function(){return this.getObject()&&(this.$percentLoaded=this.getObject().PercentLoaded()),100==this.$percentLoaded},domReady:function(){MooKrpano_Global_SuperObject.panos[this.options.parameters.id]=this,this.setEvents(),this.fireEvent("onDomReady")}.protect(),setEvents:function(){this.$eventsObj.each(function(t){this.set("events.".concat(t),"js( MooKrpano_Global_SuperObject.panos['".concat(this.options.parameters.id,"'].",t,"() );"))},this)}.protect(),onenterfullscreen:function(){this.fireEvent("enterfullscreen",this.getfullscreen())},onexitfullscreen:function(){this.fireEvent("exitfullscreen",this.getfullscreen())},onxmlcomplete:function(){this.fireEvent("xmlcomplete",this.getxml())},onpreviewcomplete:function(){this.fireEvent("previewcomplete")},onloadcomplete:function(){this.fireEvent("loadcomplete")},onkeydown:function(){this.fireEvent("keydown",this.getkeycode())},onkeyup:function(){this.fireEvent("keyup",this.getkeycode())},onclick:function(){this.fireEvent("click",this.getmouseposition())},onmousedown:function(){this.fireEvent("mousedown",this.getmouseposition())},onmouseup:function(){this.fireEvent("mouseup",this.getmouseposition())},onmousewheel:function(){this.fireEvent("mousewheel",this.getwheeldelta())},onidle:function(){this.fireEvent("idle",this.getidletime())},onviewchange:function(){this.fireEvent("viewchange",this.getlookat())},onresize:function(){this.fireEvent("resize",this.getwindowsize())},onloaderror:function(){this.fireEvent("loaderror",this.getlasterror())},getversion:function(){return this.get("version")},getxmlversion:function(){return this.get("xmlversion")},getbuild:function(){return this.get("build")},getfullscreen:function(){return this.get("fullscreen")},getstagesize:function(){return{stagewidth:this.get("stagewidth"),stageheight:this.get("stageheight")}},getdevice:function(){return{isphone:this.get("isphone"),ispad:this.get("ispad"),isandroid:this.get("isandroid"),isflash:this.get("isflash"),ishtml5:this.get("ishtml5")}},gettimertick:function(){return this.get("timertick")},getrandom:function(){return this.get("random")},getmoveforces:function(){return{hlookat_moveforce:this.get("hlookat_moveforce"),vlookat_moveforce:this.get("vlookat_moveforce"),fov_moveforce:this.get("fov_moveforce")}},getxml:function(){return{url:this.get("xml.url"),content:this.get("xml.content"),scene:this.get("xml.scene")}},getlasterror:function(){return this.get("lasterror")},getkeycode:function(){return this.get("keycode")},getmouseposition:function(){return this.call("screentosphere(mouse.x, mouse.y, mouse_ath, mouse_atv)"),{x:this.get("mouse.x"),y:this.get("mouse.y"),ath:this.get("mouse_ath"),atv:this.get("mouse_atv"),stagex:this.get("mouse.stagex"),stagey:this.get("mouse.stagey")}},getmousewheel:function(){return this.get("wheeldelta")},getlookat:function(){return{hlookat:this.get("view.hlookat"),vlookat:this.get("view.vlookat"),fov:this.get("view.fov")}},getautorotate:function(){return{enabled:this.get("autorotate.enabled"),waittime:this.get("autorotate.waittime"),accel:this.get("autorotate.accel"),speed:this.get("autorotate.speed"),horizon:this.get("autorotate.horizon"),tofov:this.get("autorotate.tofov")}},getidletime:function(){return this.get("idletime")},getdatacontent:function(t){return this.get("data[".concat(t,"].content"))},getplugincount:function(){return this.get("plugin.count")},gethotspotcount:function(){return this.get("hotspot.count")},screentosphere:function(t,e){this.set("mookrpano_x",t),this.set("mookrpano_y",e);var n=(this.call("screentosphere(mookrpano_x, mookrpano_y, mookrpano_ath, mookrpano_atv)"),{ath:this.get("mookrpano_ath"),atv:this.get("mookrpano_atv")});return n},spheretoscreen:function(t,e){this.set("mookrpano_ath",t),this.set("mookrpano_atv",e);var n=(this.call("spheretoscreen(mookrpano_ath, mookrpano_atv, mookrpano_x, mookrpano_y)"),{x:this.get("mookrpano_x"),y:this.get("mookrpano_y")});return n},setidletime:function(t){this.set("idletime",t)},setmovingforces:function(t){if("object"===typeOf(t)){var e=this.getmovingforces();Object.merge(e,t),Object.each(e,function(t,e){this.set(e,String.from(t))},this)}},setautorotate:function(t){if("object"==typeOf(t)){var e=this.getAutorotate();Object.merge(e,t),Object.each(e,function(t,e){this.set(e,String.from(t))},this)}},setdatacontent:function(t,e){this.set("data[".concat(t,"].content"),String.from(e))},setplugin:function(t,e,n){this.set("plugin[".concat(t,"].",e),String.from(n))},sethotspot:function(t,e,n){this.set("hotspot[".concat(t,"].",e),String.from(n))}});var MooKrpano_Global_SuperObject={panos:{}};